<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Go Guide</title>
    <link rel="stylesheet" href="./lib/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="./lib/onsenui/css/onsen-css-components.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="./lib/onsenui/js/onsenui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/common.css">

    <style>

    </style>
</head>

<body>
<ons-navigator swipeable id="myNavigator" page="base-template" animation="slide"></ons-navigator>

<!-- BASE TEMPLATE -->
<template id="base-template">
    <ons-page id="base-page">

        <ons-tabbar id="base-tabbar" position="bottom">
            <ons-tab page="home-template" label="Home" icon="md-home" active>
            </ons-tab>
            <ons-tab page="pokedex-template" label="Pokedex" icon="md-book">
            </ons-tab>
            <ons-tab page="tips-template" label="Tips" icon="md-key">
            </ons-tab>
            <ons-tab page="about-template" label="About" icon="md-library">
            </ons-tab>
        </ons-tabbar>
    </ons-page>
</template>


<!-- HOME TEMPLATE -->
<template id="home-template">
    <ons-page id="home">
        <div class="wrapper">
            <ons-toolbar modifier="material transparent">
                 <div class="center">Home</div>
            </ons-toolbar>
            <div id="bannerWrapper">
            <ons-card id="banner">
                <div id="pika"> <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/dream-world/25.svg"></div>
                <div id="hero">
                <h1 id="slogan">Pokemon Go Guide</h1>
                <p> The only companion app you need for Pokemon Go info!</p>
                </div>
            </ons-card>
            </div>
            <div class="carouselWrapper">
            <h2 class="carouselName">Rare Pokemons Sighted</h2>
            <ons-carousel item-width="160px" fullscreen swipeable auto-scroll overscrollable id="rarePokeList" class="carouselList"></ons-carousel>
            </div>
            <div class="carouselWrapper">
            <h2 class="carouselName">Common Pokemons in the Area</h2>
            <ons-carousel item-width="160px" fullscreen swipeable auto-scroll overscrollable id="commonPokeList" class="carouselList"></ons-carousel>
            </div>
        </div>
    </ons-page>
</template>

<!-- POKEDEX TEMPLATE -->
<template id="pokedex-template">
    <ons-page id="pokedex">
        <div class="wrapper">
        <ons-toolbar modifier="material transparent">
            <div class="center">Pokedex</div>
        </ons-toolbar>
        <div id="listWrapper">
            <p style="text-align: center; margin-top: 10px;">
                <ons-search-input
                id="searchInput"
                placeholder="Search Pokemons"
                  type="text"
                  onchange="filter()"
                ></ons-search-input>
                <button id="refreshBtn" onclick="refreshList()" class="button--quiet"><ons-icon icon="md-refresh" size="20px"></ons-icon></button>
              </p>
        <ons-list style="background-color:rgba(255,255,255,0.5)">
            <ons-lazy-repeat id="dynamic-list">

            </ons-lazy-repeat>
        </ons-list>
        </div>
        </div>
    </ons-page>
</template>

<!-- POKEDEX DETAILS PAGE -->
<template id="pokedexDetail-template">
    <ons-page id="pokedexDetail">
        <div class="wrapper">
        <ons-toolbar modifier="material transparent">
            <div class="left"><ons-back-button>Back</ons-back-button></div>
            <div class="center" id="pIndex"></div>
        </ons-toolbar>
            <div class="pokeimg"><img id="pokeimg" style="width:auto;height:50vh;" > </div>
            <ons-card style="border-radius:1em;padding-bottom:1.5em;">
            <div class="name"><h1 id="pokeName"></h1></div>
            <div id="details">
            <div class="box">
                <h5> Type </h5>
                <span class="detail" id="type1"></span>
                <span class="detail" id="type2"></span>
            </div>
            <div class='box'>
                <h5> Height </h5>
                <span class="detail" id="height"></span>
            </div>
            <div class='box'>
                <h5> Weight </h5>
                <span class="detail" id="weight"></span>
            </div>
        </div>
        <h3>Stats</h3>
            <div class="center" id="stats">
            </div>
        </ons-card>
    </div>
    </ons-page>
</template>



<!-- TIPS TEMPLATE -->

<template id="tips-template">
  <ons-navigator id="nav">
    <ons-page >
    <div class="wrap">
      <ons-toolbar modifier="material transparent">
        <div class="center"> Tips </div>
      </ons-toolbar>
      <div id="bannerWrapper">

      <div class="tipbanner" >
      <div class="topic">
      <h2>Choose your topic </h2>
      <p>  Get access to tips archive and become an expert in Pokemon Go!</p>
      </div>
    </div>

  </div>



      <ons-gesture-detector>

      <div class="swipe-grid">

        <div class="swipe-space box1" modifier="nodivider" onclick="nav.pushPage('pages/rare.html')">
          <div class="center">
            <span class="list-item__title">Catch rare pokemons </span>
            <center><img class="list-item__thumbnail" src="img/Pokeball.png"></Center>
          </div>
        </div>


        <div class="swipe-space box2"  modifier="nodivider" onclick="nav.pushPage('pages/beginners.html')">
          <div class="center">
            <span class="list-item__title"> Tips for beginners </span>
            <center><img class="list-item__thumbnail" src="img/Rare.png"></Center>
          </div>
        </div>


        <div class="swipe-space box3" modifier="nodivider" onclick="nav.pushPage('pages/evolution.html')">
          <div class="center">
            <span class="list-item__title">  Evolution items  </span>
            <center><img class="list-item__thumbnail" src="img/Gengar.png"></Center>

          </div>
        </div>


        <div class="swipe-space box4"  modifier="nodivider" onclick="nav.pushPage('pages/raids.html')">
          <div class="center">
            <span class="list-item__title"> Pokemon Go raids</span>
            <center><img class="list-item__thumbnail" src="img/Raid.png"></Center>
            <!-- <span class="list-item__subtitle">(Tap here to view profile)</span> -->
          </div>
        </div>
      </ons-gesture-detector>

</div>
      </div>
    </ons-page>
  </ons-navigator>
</template>




<!-- ABOUT TEMPLATE -->


<template id="about-template">
  <ons-page>
    <div class="wrapper">
    <ons-toolbar modifier="material transparent">
      <div class="center">  About Pokemon Go </div>
    </ons-toolbar>
  <div id="about"><img style="width: 100%;" src="./img/about0.jpg"></div>

    <ons-card>
      <div class="title"> <br> A brief history of Pokémon: from red and green to catching Pikachu </div>
      <div class="content aboutcontent">
        <p>Japanese game developer Satoshi Tajiri came up with the idea of Pokemon because he loved collecting and trading insects with his friends</p>
        <p>As a child, Satoshi loved collecting insects; he was fascinated by the idea of having different species, and enjoyed trading them with his friends. This would later inspire him to create Poketto Monsuta, or Pocket Monsters, now more commonly known by its abbreviated name, Pokemon. Creating his first Pokemon game would take six long and gruelling years, that almost forced his game development company Game Freak into bankruptcy – but let’s look how far it’s come.
      </p>
      <div><img style="width: 100%;" src="./img/about1.png"></div>

      <h4> <br>Pokemon Red and Green (Japan), Pokemon Red and Blue (USA), Pokemon Yellow 1996-1999</h4>
      <p>It all started with the 151 original, first-generation Pokemon from the Kanto region, which were introduced in Pokemon Red and Green. The game’s story follows a boy on a quest to become the greatest Pokemon trainer, by collecting all the gym badges and completing his Pokedex. Players eventually have to face the Elite Four, the final four bosses, and the Legendary Pokemon Birds Articuno, Zapdos and Moltres. Powerful Mewtwo and mythical Pokemon Mew are also up for grabs. While all three versions were released for the Game Boy console, Pokemon Red and Green were released in Japan in 1996, followed by Pokemon Red and Blue for the United States in 1998. All three games quickly became a cultural phenomenon which got everyone trying to “catch ’em all”. Pokemon Red and Green was later remastered for the Game Boy Advance as Pokemon Fire Red and Leaf Green in 2004<br>
        Pokemon Yellow was released in 1998 for Japan and in 1999 for the US; this remake was a result of the popularity of the Pokemon animated TV series. Players received Pikachu as their starter Pokemon instead of having to choose between the three original starter Pokemon: Bulbasaur, Charmander and Squirtle.Pikachu follows you around throughout your adventure, just like Ash’s Pikachu in the TV series. This allows players to interact with the mouse-like Pokemon, a feature that was implemented in later Pokemon games. Pesky villain Team Rocket’s Jesse and James were also added to mirror the TV series.This year, Pokemon: Let’s Go Pikachu and Let’s Go Eevee were released as remastered versions of the original Pokemon Yellow.
      </p>
      <img style="width: 100%;" src="./img/about2.jpg">

      <h4><br>Pokemon Gold and Silver, Pokemon Crystal 1999-2001</h4>
      <p>When legendary gen II Pokemon Ho-Oh was revealed at the end of the very first episode of the Pokemon TV series, fans sensed there was more to come. And sure enough, Pokemon Gold and Silver were released in 1999 for Japan, America in 2000, and Europe in 2001 following suit.This generation of Pokemon games was released for the Game Boy Colour, giving the Pokemon world a new level of vibrancy. The game introduced 100 new species of Pokemon, with three new starters, and three
        new Legendary Pokemon to accompany Ho-Oh and Lugia.The games offered more to catch and more to battle with, and players were thrilled to explore the new Johto region. The two games were later remastered as Pokemon HeartGold and SoulSilver for the Nintendo DS in 2010. Pokemon Silver and Gold were later remade as Pokemon Crystal with new and improved animation and design. This version of the game was the first to allow players to choose the gender of their avatar.
      </p>
      <img style="width: 100%;" src="./img/about3.png">

      <h4><br>Pokemon Ruby and Sapphire, Pokemon Emerald 2003-2005</h4>
      <p> Nintendo’s release of the Game Boy Advance brought about the release of Pokemon Ruby and Sapphirein 2003, introducing yet another generation of Pokemon. The Hoenn region opened a door to many more puzzles, gyms, and Pokemon to catch and battle with. The gen III games were remastered and released in 2014 for the 3DS console as Pokemon Omega Ruby and Alpha Sapphire.A special edition, titled Pokemon Emerald, was launched in Japan in 2004, and in 2005 everywhere else. In this edition, Legendary Pokemon Rayquaza was added, with new story elements to extend the gameplay.
       </p>

       <h4><br>Pokemon Gen IV, V, VI, VII</h4>
       <p>Over the past two decades, there have been many other successful Pokemon games, including Pokemon Stadium/ Colosseum, the Pokemon Mystery Dungeon series, and, of course, Pokemon Go. Game Freak made four more generations after Gen III – and we don’t think they’ll stop there.
      </p>
      <img style="width: 100%;" src="./img/about4.png">


    </ons-card>
    </div>
  </ons-page>
</template>





<!-- ******************** spinner modal ******************** -->
<ons-modal id="spinnerModal">
    <div style="margin: auto;">
        <ons-icon icon="md-spinner" size="100px" spin></ons-icon>
    </div>
</ons-modal>

</body>

<script>
    var pokeCount = '';
    document.addEventListener('init', function(event){
                var page = event.target;
                if(page.id === 'home'){
                    rarePokemonCarousel();
                    commonPokemonCarousel();
                }
                if(page.id === 'pokedex'){
                    getPokemon();
                }
                if(page.id === 'pokedexDetail'){
                    pokemonDetails(page.data.pokeIndex);
                }
    });

    function getPokemon() {


        // the lazy list element

        var API = 'https://pokeapi.co/api/v2/pokemon/?offset=0&limit=411';

        $.ajax(API)
                .done(function(poke){
                    console.log(poke.results[8].name);
                    appendPokedex(poke.results);
                })
                .fail(function(xhr,status,error){
                    console.log('error:'+xhr.status+'-'+JSON.stringify(xhr));
                })
                .always(function(){
                    spinnerModal.hide();
                })

        }

    function appendPokedex(pokemon){
        var dynList = document.getElementById('dynamic-list');
        // console.log('l='+pokemon.length);
        for(i=0;pokemon.length;i++){
        n = i+1;
        dynList.appendChild(
                ons.createElement(
                    '<ons-list-item class="pokeListItem" id="' + pokemon[i].name + '">' +
                    '<div class="left"><img class="list-item__thumbnail" src="https://pokeres.bastionbot.org/images/pokemon/' + n + '.png"></div>' +
                    '<div class="center"><span class="list-item__title">' + pokemon[i].name + '</span><span     class="list-item__subtitle"> #' + n + '</span></div>' +
                    '<div class="right"><ons-button style="background-color:#ff0000;" onclick="pushSingleView(' + i +')" icon="md-caret-right"></ons-button></div>' +
                    '</ons-list-item>'
                )
            )
         }
    }

    function pushSingleView(index){
        document.querySelector('#myNavigator').pushPage('pokedexDetail-template', {data:{pokeIndex:index}});
    }

    function pokemonDetails(index){

        n = index+1;
        console.log(n);
        var API = 'https://pokeapi.co/api/v2/pokemon/' + n;
        $.getJSON(API, function(data){

            var pokeImg = data.sprites.other.dream_world.front_default,
            pokeId = data.id,
            pokeName = data.name,
            pokeType1 = data.types[0].type.name,
            pokeHeight = data.height *10,
            pokeWeight = data.weight/10,
            pokeStatsCount = data.stats.length,
            pokeStats = data.stats;
            if (data.types.length == 2){
                var pokeType2 = data.types[1].type.name;
            }
            else {
                var pokeType2 = null;
            }


            $('#pokeimg').attr('src', pokeImg);
            $('#pokeName').text(pokeName);
            $('#type1').text(pokeType1);
            $('#type2').text(pokeType2);
            $('#height').text(pokeHeight + 'cm');
            $('#weight').text(pokeWeight + 'kg');
            $('#pIndex').text('Pokemon ' + pokeId);

            for(i=0;i<pokeStatsCount;i++){
                $('#stats').append(
                    ons.createElement(
                        '<div class="container">' +
                        '<span id="statTitle">' + pokeStats[i].stat.name + ' ' + pokeStats[i].base_stat + '</span>' +
                        '<div class="progress-bar" modifier="material modifier2" style="height:10px;">' +
                        '<div class="progress-bar__primary" style="width:' + pokeStats[i].base_stat + '%"></div>' +
                        '<div class="progress-bar__secondary" style="width:100%"></div></div></div>'
                    )
                )
            }
        })
    }

    function rarePokemonCarousel(){
        var API = 'https://pokeapi.co/api/v2/pokemon/?offset=401&limit=411';

        $.ajax(API)
                .done(function(poke){

                    for(i=0;i<10;i++){
                    n = i + 402;
                    var time = Math.floor(Math.random() * 60);
                    var distance = Math.floor(Math.random() * 1000);
                    var pokeName = poke.results[i].name;
                    $('#rarePokeList').append(
                        ons.createElement(
                            '<ons-card style="border-radius:1em;">' +
                            '<img src="https://pokeres.bastionbot.org/images/pokemon/' + n + '.png">' +
                            '<h3>' + pokeName + '</h3>' +
                            '<p>' + time + ' minutes ago </p>' +
                            '<p>' + distance + ' meters away </p>' +
                            '<div class="carouselbtn"><ons-button modifier="quiet" onclick="pushSingleView(' + (n-1) +')">' + '<ons-icon icon="md-caret-right" size="30px" style="color:red;"></ons-icon></ons-button></div>' +
                            '</ons-card>' 
                        )
                    )
                }

                })
                .fail(function(xhr,status,error){
                    console.log('error:'+xhr.status+'-'+JSON.stringify(xhr));
                })
                .always(function(){
                    spinnerModal.hide();
                })
    }

    function commonPokemonCarousel(){
        var API = 'https://pokeapi.co/api/v2/pokemon/?offset=91&limit=100';

        $.ajax(API)
                .done(function(poke){

                    for(i=0;i<10;i++){
                    n = i + 92;
                    var time = Math.floor(Math.random() * 60);
                    var distance = Math.floor(Math.random() * 1000);
                    var pokeName = poke.results[i].name;
                    $('#commonPokeList').append(
                        ons.createElement(
                            '<ons-card style="border-radius:1em;">' +
                            '<img src="https://pokeres.bastionbot.org/images/pokemon/' + n + '.png">' +
                            '<h3>' + pokeName + '</h3>' +
                            '<p>' + time + ' minutes ago </p>' +
                            '<p>' + distance + ' meters away </p>' +
                            '<div class="carouselbtn"><ons-button modifier="quiet" onclick="pushSingleView(' + (n-1) +')">' + '<ons-icon icon="md-caret-right" size="30px" style="color:red;"></ons-icon></ons-button></div>' +
                            '</ons-card>' 
                        )
                    )
                }

                })
                .fail(function(xhr,status,error){
                    console.log('error:'+xhr.status+'-'+JSON.stringify(xhr));
                })
                .always(function(){
                    spinnerModal.hide();
                })
    }

    function filter(){

        input = document.getElementById('searchInput');
        query = input.value.trim().toLowerCase();
        // var query = $('#searchInput').value.toLowerCase();Error - query is undefined
        console.log(query);
        var pokeList = document.getElementById('dynamic-list');
        var pokeLi = pokeList.getElementsByClassName('pokeListItem');

        for(i=0;i<pokeLi.length;i++){
            console.log(pokeLi[i]);
            var pokeName = pokeLi[i].id;
            console.log(query, pokeName);
            if(query){
                index = pokeName.indexOf(query);
            }
            pokeLi[i].style.display = index === -1 ? 'none':'';
        };
    }

    function refreshList(){
        var pokeList = document.getElementById('dynamic-list');
        var pokeLi = pokeList.getElementsByClassName('pokeListItem');
        for(i=0;i<pokeLi.length;i++){
        pokeLi[i].style.display = '';
        }
    }


</script>
</html>
